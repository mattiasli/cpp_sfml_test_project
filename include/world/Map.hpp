#pragma once
#include <memory>    // TODO: only for test, remove.
#include <SFML/Graphics.hpp>
#include "../entities/dynamicentities/DynamicEntity.hpp"
#include "../entities/dynamicentities/Player.hpp"
#include "../entities/dynamicentities/GuardSwordsman.hpp"
#include "../entities/dynamicentities/GuardSpearman.hpp"
#include "../entities/dynamicentities/CitizenMale.hpp"
#include "../entities/dynamicentities/CitizenFemale.hpp"
#include "../entities/dynamicentities/Wolf.hpp"
#include "../entities/dynamicentities/Snake.hpp"

#include "../graphics/Animator.hpp"    // TODO: only for test, remove.

class Handler;

class Map {
public:
    Map(Handler& handler);

    void updateLogic();
    void render();

    bool isTileSolid(char tile); // TODO: flyweight.
    bool isGridCoordinateSolid(sf::Vector2i gridCoordinate); // TODO: flyweight.
    bool isGridCoordinateInsideMapGrid(sf::Vector2i gridCoordinate) const;

    int getGridWidth() const;
    int getGridHeight() const;



    std::weak_ptr<Animator> tempAnimator;    // TODO: only for test, remove.

private:
    Handler& handler;
    std::vector<std::vector<char>> mapGrid {
        {'#', '#', '#', '#', '#', '#', '#', '#', '~', '#', '#', '#', '#', '_', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#'},
        {'#', '_', '_', '_', '_', '_', '~', '~', '~', '~', '~', '_', '_', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '#'},
        {'#', ' ', ' ', ' ', ' ', ' ', '_', '~', '~', '~', '_', '_', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '#'},
        {'#', ' ', ' ', ' ', ' ', ' ', ' ', '_', '_', '_', '_', '_', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '#'},
        {'#', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '_', ' ', ' ', ' ', ' ', ' ', '^', '^', ' ', ' ', ' ', ' ', ' ', ' ', '#'},
        {'#', '^', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '#', '_', ' ', ' ', ' ', ' ', '#', '#', '^', '^', '_', ' ', ' ', ' ', '#'},
        {'#', '^', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '_', ' ', '#', '~', '_', ' ', ' ', ' ', ' ', '#', '#', '#', '_', ' ', ' ', ' ', '#'},
        {'#', '^', '_', ' ', ' ', ' ', ' ', '_', '_', ' ', '_', '_', '_', '_', '_', ' ', '#', '#', '~', '_', ' ', ' ', '^', '#', '#', '#', '^', '_', ' ', ' ', ' ', '#'},
        {'#', '_', ' ', ' ', ' ', ' ', '_', '^', '~', '_', '^', '^', '^', '_', '_', '^', '#', '#', '_', ' ', ' ', ' ', '^', '#', '#', '^', '_', '_', '_', '_', ' ', '#'},
        {'#', ' ', ' ', ' ', ' ', '_', '^', '~', '~', '~', '~', '~', '^', '_', '_', '^', '#', '#', '_', ' ', ' ', ' ', ' ', '^', '^', '_', ' ', '_', '_', '_', ' ', '#'},
        {'#', ' ', ' ', ' ', ' ', '_', '^', '~', '~', '^', '~', '~', '^', '_', '_', '^', '^', '^', '_', ' ', ' ', ' ', ' ', ' ', '_', ' ', ' ', ' ', '_', ' ', ' ', '#'},
        {'#', ' ', ' ', ' ', ' ', '_', '^', '~', '~', '^', '~', '^', '_', ' ', '_', '^', '_', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '#'},
        {'#', ' ', ' ', ' ', ' ', ' ', '_', '^', '^', '_', '^', '_', ' ', ' ', ' ', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '_', '_', ' ', ' ', ' ', ' ', ' ', '#'},
        {'#', ' ', ' ', ' ', ' ', ' ', ' ', '_', '_', '_', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '^', '^', '_', ' ', ' ', ' ', ' ', '#'},
        {'~', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '^', '~', '^', '_', ' ', ' ', ' ', ' ', '#'},
        {'~', '~', '_', '_', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '^', '~', '^', ' ', ' ', ' ', ' ', ' ', ' ', '#'},
        {'~', '~', '~', '~', '_', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '_', '~', '_', ' ', ' ', ' ', ' ', ' ', ' ', '#'},
        {'~', '_', '_', '_', '~', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '_', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '#'},
        {'~', '_', '^', '_', '_', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '#'},
        {'~', '~', '^', ' ', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '#'},
        {'~', '~', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '^', '^', ' ', '#'},
        {'#', '~', '~', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '^', ' ', ' ', ' ', '#'},
        {'#', '~', '~', '^', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '^', ' ', ' ', '^', '^', '#'},
        {'_', '_', '~', '^', '_', ' ', ' ', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '^', ' ', ' ', ' ', ' ', ' ', '~'},
        {'_', '_', '~', '^', '_', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '^', ' ', ' ', '^', '^', '^', ' ', '~'},
        {'^', '#', '~', '#', '^', '^', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '^', ' ', ' ', '^', ' ', ' ', ' ', ' ', '~'},
        {'^', '#', '~', '#', '^', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '^', ' ', ' ', '^', ' ', '^', '^', '^', '~'},
        {'#', '_', '~', '_', '_', ' ', ' ', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '^', ' ', ' ', '^', ' ', ' ', ' ', '_', '~'},
        {'#', '_', '~', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '^', ' ', ' ', '_', '^', '^', ' ', '_', '~'},
        {'_', '~', '~', '~', '_', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '^', ' ', ' ', '_', '^', '^', ' ', '_', '~'},
        {'#', '~', '~', '~', '~', '_', '_', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '_', '_', ' ', ' ', '_', '^', '^', '_', '~', '~'},
        {'#', '~', '~', '~', '~', '~', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '^', '~', '~', '~', '~'}
    };
    bool solidTable[256] = { false };
    std::vector<DynamicEntity*> tempEntityVector;
};